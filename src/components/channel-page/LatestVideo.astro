---
const { data } = Astro.props;
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Play } from "lucide-react";

const uploadsPlaylistId = "UU" + data.id.slice(2);
---

<Card>
  <CardHeader>
    <CardTitle className="flex items-center gap-2 text-lg md:text-xl">
      <Play className="h-5 w-5" />
      Latest Videos from {data.title}
    </CardTitle>
    <p class="text-sm md:text-base text-slate-600">
      Watch the newest videos uploaded by <strong>{data.title}</strong>. Stay
      up-to-date with their latest content and trending topics.
    </p>
  </CardHeader>
  <CardContent>
    <div
      class="relative w-full overflow-hidden rounded-lg cursor-pointer"
      style="padding-top:56.25%"
      id="video-container"
      data-playlist-id={uploadsPlaylistId}
      data-title={data.title}
    >
      <div
        class="absolute top-0 left-0 h-full w-full bg-slate-900 flex items-center justify-center"
      >
        <Play
          className="h-16 w-16 text-white bg-red-600 rounded-full p-4 shadow-lg"
        />
      </div>
    </div>
  </CardContent>
</Card>

<script>
  const container = document.getElementById("video-container");
  const playlistId = container.dataset.playlistId;
  const channelTitle = container.dataset.title;

  container.addEventListener("click", () => {
    container.innerHTML = `
      <iframe
        src="https://www.youtube.com/embed/videoseries?list=${playlistId}&autoplay=1"
        title="Latest videos playlist of ${channelTitle}"
        class="absolute top-0 left-0 h-full w-full border-0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      ></iframe>
    `;
  });
</script>
