---
import "../styles/global.css";

const {
  pageTitle = "YouTube Income Calculator - Estimate Channel Earnings",
  pageDescription = "Use our free YouTube income calculator to check how much a channel earns from ad revenue. Works with @handle or channel ID.",
  pageUrl = "https://youtubersincome.com",
  pageImage = null,
  isBlog = false,  
  blogAuthor = "Nazrudeen", // optional, for blog posts
  blogDatePublished = null, // optional, ISO string      /
  showLoader = false,    // Only show loader if true
  showAds = false,       // Only include AdSense script if true 
} = Astro.props;

// JSON-LD Schema
let schemaJSONLD;
if (isBlog) {
  // Blog page schema
  schemaJSONLD = {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    headline: pageTitle,
    description: pageDescription,
    url: pageUrl,
    author: {
      "@type": "Person",
      name: blogAuthor
    },
    datePublished: blogDatePublished,
    mainEntityOfPage: {
      "@type": "WebPage",
      "@id": pageUrl
    },
    image: pageImage || undefined
  };
} else {
  // Normal website page schema
  schemaJSONLD = {
    "@context": "https://schema.org",
    "@type": "WebSite",
    name: pageTitle,
    url: pageUrl,
    applicationCategory: "FinanceApplication",
    operatingSystem: "All",
    description: pageDescription,
    offers: {
      "@type": "Offer",
      price: "0",
      priceCurrency: "USD"
    }
  };
}
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{pageTitle}</title>
    <link rel="canonical" href={pageUrl} />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="MyWebSite" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Primary Meta -->
    <meta name="description" content={pageDescription} />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={isBlog ? "article" : "website"} />
    <meta property="og:url" content={pageUrl} />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    {pageImage && <meta property="og:image" content={pageImage} />}

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={pageUrl} />
    <meta property="twitter:title" content={pageTitle} />
    <meta property="twitter:description" content={pageDescription} />
    {pageImage && <meta property="twitter:image" content={pageImage} />}
    
    <!-- JSON-LD Schema -->
    <script
    type="application/ld+json"
    set:html={JSON.stringify(schemaJSONLD)}
    />
    
    <link rel="sitemap" href="/sitemap.xml" />
    
    <!-- Fonts -->
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
    href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap"
    rel="stylesheet"
    /> -->
    <link rel="preload" href="/fonts/geist/Geist[wght].woff2" as="font" type="font/woff2" crossorigin />

    
 <!-- AdSense -->
    {showAds && (
      <script
        async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6521178728176260"
        crossorigin="anonymous"
      ></script>
    )}

    <!-- Google Analytic -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-3G7VEWBJE5"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
        }
        gtag("js", new Date());
        
        gtag("config", "G-3G7VEWBJE5");
        </script> -->
    <meta name="msvalidate.01" content="7D1F698089106B3D3BCAFBCA42218D14" />
  </head>
  <body class="font-geist">
    <!-- Full-page Loader -->
    {
      showLoader && (
        <div
          id="global-loader"
          class="fixed inset-0 z-50 hidden flex flex-col items-center justify-center bg-white/70 backdrop-blur-md"
        >
          <div
            class="h-12 w-12 animate-spin rounded-full border-4 border-gray-300 border-t-red-500 drop-shadow-md"
            style="border-top-color:#DC2626"
          ></div>
          <p class="mt-4 text-sm font-semibold text-gray-800 select-none animate-pulse">
            Loading, please waitâ€¦
          </p>
        </div>
      )
    }

    <slot />

   {showLoader && (
    <script>
      function attachLoaderEvents() {
        const loader = document.getElementById("global-loader");
        const forms = document.querySelectorAll("form");

        forms.forEach((form) => {
          form.addEventListener("submit", () => {
            loader.classList.remove("hidden");
          });
        });
      }

      window.addEventListener("DOMContentLoaded", attachLoaderEvents);
      window.addEventListener("pageshow", () => {
        document.getElementById("global-loader")?.classList.add("hidden");
        attachLoaderEvents();
      });
    </script>
  )}
  </body>
</html>
